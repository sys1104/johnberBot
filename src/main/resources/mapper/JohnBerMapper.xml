<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="com.song.dao.JohnBerDao">

	<select id="getChatId" parameterType="String" resultType="String">
		SELECT CHAT_ID 
		  FROM USER_INFO
		 WHERE CHAT_ID = #{chatId}
	</select>

	<insert id="regItem" parameterType="hashmap">
		INSERT INTO WISH_LIST(SEQ, CHAT_ID, ITEM_NAME, ITEM_PRICE, URL) 
		VALUES(WISH_LIST_SEQ.NEXTVAL, #{chatId}, #{itemName}, #{itemPrice}, #{url})
	</insert>
	
	<insert id="regUser" parameterType="String">
		INSERT INTO USER_INFO(CHAT_ID, REG_DATE) VALUES(#{chatId}, TO_CHAR(SYSDATE, 'YYYYMMDD'))
	</insert>	
	
	<delete id="delUser" parameterType="String">
		DELETE USER_INFO WHERE CHAT_ID = #{chatId}
	</delete>	
	
	<select id="getPrice" parameterType="map" resultType="Integer">
		SELECT A.ITEM_PRICE
		   FROM WISH_LIST A
		 WHERE A.CHAT_ID = #{chatId}
		     AND A.ITEM_NAME = #{itemName} 
	</select>

	<select id="getWishListAll" resultType="hashmap">
		SELECT A.CHAT_ID, A.ITEM_NAME, A.ITEM_PRICE, A.URL
		   FROM WISH_LIST A
	</select>

	<update id="updatePrice" parameterType="hashmap">
		UPDATE WISH_LIST 
		     SET ITEM_PRICE = #{itemPrice}
		 WHERE CHAT_ID = #{chatId}
		     AND ITEM_NAME = #{itemName}
	</update>

</mapper>